<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>컴퓨터 구조 - 파이프라인</title><meta name="description" content="흔히 어떤 일을 수행하기 위해서 single cycle을 생각하는 것이 흔하다. 하나의 기계가 있다면 그 기계는 일단 하나를 수행 완료한 뒤에 다른 것을 수행하는 것이 정상적으로 느껴진다. 하지만, 수행하는 일을 단계로 나눠서 한꺼번에 여러 단계를 수행할 수 있게 하면 어떨까? 각 단계를 중첩해서 실행하게 하면 걸리는 시간이 크게 줄어지는 것을 확인할 수 있다."/><meta name="title" content="컴퓨터 구조 - 파이프라인"/><meta property="og:image" content="https://donghunkim.dev/assets/posts/pipeline/thumbnail.png"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#000000"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><meta name="og:sitename" content="Donghun Kim | Developer"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta name="google-site-verification" content="l9pNikVAOmXekB00LXYnclf9f_nyVIIjDvu4s2DdYtQ"/><meta name="next-head-count" content="17"/><link rel="preload" href="/_next/static/media/5d7fcf765059a344-s.p.otf" as="font" type="font/otf" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/ac7c9f14c7799d15-s.p.otf" as="font" type="font/otf" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/535c141938fc81c3-s.p.otf" as="font" type="font/otf" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/e11418ac562b8ac1-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/css/a955ec04d7fe9324.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/a955ec04d7fe9324.css" crossorigin="" data-n-g=""/><link rel="preload" href="/_next/static/css/92b5d4034cf97289.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/92b5d4034cf97289.css" crossorigin="" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee7e63bc15b31913.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-66d32731bdd20e83.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-5d77cecfe18a5947.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-e35f58c0210c308e.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/fb7d5399-77a75513571cc99c.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/317522db-a1e300886af6caee.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/336-0626ea9457c579cc.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/619-9195e5b60e53e070.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/634-c75673bec9d82092.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-ebb65febdc7954e7.js" defer="" crossorigin=""></script><script src="/_next/static/kHIBZDqh5Me3FZRStPnag/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/kHIBZDqh5Me3FZRStPnag/_ssgManifest.js" defer="" crossorigin=""></script></head><body class="bg-[black]"><div id="__next"><style data-mantine-styles="classes">@media (max-width: 35.99375em) {.mantine-visible-from-xs {display: none !important;}}@media (min-width: 36em) {.mantine-hidden-from-xs {display: none !important;}}@media (max-width: 47.99375em) {.mantine-visible-from-sm {display: none !important;}}@media (min-width: 48em) {.mantine-hidden-from-sm {display: none !important;}}@media (max-width: 61.99375em) {.mantine-visible-from-md {display: none !important;}}@media (min-width: 62em) {.mantine-hidden-from-md {display: none !important;}}@media (max-width: 74.99375em) {.mantine-visible-from-lg {display: none !important;}}@media (min-width: 75em) {.mantine-hidden-from-lg {display: none !important;}}@media (max-width: 87.99375em) {.mantine-visible-from-xl {display: none !important;}}@media (min-width: 88em) {.mantine-hidden-from-xl {display: none !important;}}</style><main class="__variable_56c696 __variable_3a0388"><div class="" style="position:fixed;top:0;left:0;height:2px;background:transparent;z-index:99999999999;width:100%"><div class="" style="height:100%;background:rgba(255,255,255,0.8);transition:all 500ms ease;width:0%"><div style="box-shadow:0 0 10px rgba(255,255,255,0.8), 0 0 10px rgba(255,255,255,0.8);width:5%;opacity:1;position:absolute;height:100%;transition:all 500ms ease;transform:rotate(2deg) translate(0px, -2px);left:-10rem"></div></div></div><div style="transition:all 0.3s ease-in-out;backdrop-filter:blur(10px);align-items:center;justify-content:space-between;padding-left:calc(1.25rem * var(--mantine-scale));padding-right:calc(1.25rem * var(--mantine-scale));background:rgba(0,0,0,0.2);width:100%;height:calc(3.5rem * var(--mantine-scale));position:fixed" class="z-50 text-white m_8bffd616 mantine-Flex-root __m__-R2nm"><div style="transform:rotate(0deg);transition:transform 500ms" class="cursor-pointer transition-all"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="tabler-icon tabler-icon-arrow-up "><path d="M12 5l0 14"></path><path d="M18 11l-6 -6"></path><path d="M6 11l6 -6"></path></svg></div><style data-mantine-styles="inline">.__m__-Rbbanm{position:relative;}@media(min-width: 62em){.__m__-Rbbanm{position:absolute;left:50%;}}</style><div style="white-space:nowrap;transform:translate(-50%, 0);gap:var(--mantine-spacing-sm)" class="m_8bffd616 mantine-Flex-root __m__-R1banm __m__-Rbbanm"><style data-mantine-styles="inline">.__m__-R2rbanm{max-width:calc(-6.25rem * var(--mantine-scale));}@media(min-width: 62em){.__m__-R2rbanm{max-width:none;}}</style><p class="mantine-focus-auto truncate m_b6d8b162 mantine-Text-root __m__-R2rbanm"><span class="mantine-focus-auto w-fit m_b6d8b162 mantine-Text-root"><span class="mantine-focus-auto font-sans font-medium m_b6d8b162 mantine-Text-root">computer-architecture</span><span style="margin-left:calc(0.3125rem * var(--mantine-scale));margin-right:calc(0.3125rem * var(--mantine-scale))" class="mantine-focus-auto m_b6d8b162 mantine-Text-root">|</span><span class="mantine-focus-auto font-sans font-normal m_b6d8b162 mantine-Text-root">컴퓨터 구조 - 파이프라인</span></span></p></div><style data-mantine-styles="inline">.__m__-R1ranm{display:none;}@media(min-width: 62em){.__m__-R1ranm{display:block;}}</style><div class="__m__-R1ranm"><p class="mantine-focus-auto font-sans m_b6d8b162 mantine-Text-root">2022-08-23</p></div></div><div style="height:300px;background-image:url(/assets/background/noise30.png)" class="relative"><div style="height:150px;width:100%;background-image:linear-gradient(to top, rgba(0,0,0,1), rgba(0,0,0,0));position:absolute;top:calc(9.375rem * var(--mantine-scale));left:0rem" class=""></div></div><div class="relative min-h-screen text-[#fff] overflow-x-hidden"><main><div class="container mx-auto px-5 max-w-5xl"><article class="mb-32"><div class="max-w-3xl mx-auto"><div style="gap:var(--mantine-spacing-lg);flex-direction:column" class="mb-6 text-lg m_8bffd616 mantine-Flex-root __m__-R5knm"><p style="--text-fz:calc(2.5rem * var(--mantine-scale));--text-lh:40px;line-height:1.2em;letter-spacing:1px" class="mantine-focus-auto font-tiempos m_b6d8b162 mantine-Text-root">컴퓨터 구조 - 파이프라인</p><p style="margin-top:calc(0.5rem * var(--mantine-scale));opacity:0.5" class="mantine-focus-auto font-tiempos font-thin m_b6d8b162 mantine-Text-root"><span class="mantine-focus-auto font-sans m_b6d8b162 mantine-Text-root">Posted on:</span><span style="margin-left:calc(0.3125rem * var(--mantine-scale))" class="mantine-focus-auto font-sans m_b6d8b162 mantine-Text-root">2022-08-23</span></p><p class="mantine-focus-auto font-sans font-thin m_b6d8b162 mantine-Text-root">Category:<!-- --> <span class="mantine-focus-auto font-sans m_b6d8b162 mantine-Text-root">computer-architecture<!-- --> </span></p></div></div><div class="max-w-3xl mx-auto"><div class="markdown-styles_markdown__MNzbo"><h2>Make Common Case Fast!</h2>
<p>컴퓨터 발전에 있어서 제일 중요한 것은 최적화였다. 어떻게 하면 컴퓨터의 부하를 낮추고 성능을 높일 수 있을까? 이를 접근할 수 있는 방법은 다양하지만, 2022년 1학기 컴퓨터구조 수업에서 배웠던 가장 중요한 것은 common case를 빠르게 만드는 것이었다. 자주 일어나는 것은 최대한 최적화를 하고, 그 과정에서 다른 것이 significant해지면 또 그것을 최적화하는 식으로 최적화를 진행하는 것이다.</p>
<h2>Two most important concepts</h2>
<p>교수님께서 말씀하시길 컴퓨터구조에서 면접은 두가지밖에 없다 <code>Pipeline</code>과 <code>cache</code>이다.</p>
<h3>Pipeline!</h3>
<p>여러 instruction을 병렬 수행하는 것이라고 보면 된다. Risc-v에서 배운 pipeline 단계는 Instruction Fetch, Instruction Decode / Register Read, Execute, Memory fetch, Write back 이었다.</p>
<p><img src="/assets/posts/pipeline/thumbnail.png" alt="pipeline memo"></p>
<p>위는 교재 ppt 자료이다. 흔히 어떤 일을 수행하기 위해서 single cycle을 생각하는 것이 흔하다. 하나의 기계가 있다면 그 기계는 일단 하나를 수행 완료한 뒤에 다른 것을 수행하는 것이 정상적으로 느껴진다. 하지만, 수행하는 일을 단계로 나눠서 한꺼번에 여러 단계를 수행할 수 있게 하면 어떨까? 각 단계를 중첩해서 실행하게 하면 걸리는 시간이 크게 줄어지는 것을 확인할 수 있다.</p>
<p>이런 것을 병렬적 수행이라고 볼 수 있는데, 하드웨어는 대부분 병렬적 수행을 하도록 프로그램 되어있다고 보아도 괜찮다. (그렇게 안 되어있으면 컴퓨터는 아예 쓰는 게 불가능하다..) 이러한 단계를 나누는 것을 pipeline이라고 하는데, 한 stage에 중첩되어서 최대로 할 수 있는 일의 갯수를 pipeline depth라고 한다. 지금 우리 사진에서는 depth가 5다.</p>
<p>다만 pipeline을 성능을 매우 높이더라도 여러 성가신 일들을 벌인다. 예로들면 Register Fetch를 하는데 이전 instruction에서 Mem 단계에서 load해서 값을 업데이트한 register를 실제로 읽어야 한다면 문제가 생긴다. 이럴 경우 해결방법은 해당 inst가 수행 완료될때까지 stall할 수 있다. 하지만 이럴 경우 pipelline을 도입하는 것이 무의미해진다. 동시에 여러 일을 수행하기 위해서 pipeline을 도입했는데, 이전 instruction이 수행 완료 될때까지 기다리는 일을 반복하면 pipeline이 없는 것이랑 다를 바 없다. 이와 같은 성가신 문제들을 hazard라고 부르는데, 여기 컴퓨터 pipeline에서 대표적 hazard는 structural hazard, data hazard, control hazard 가 있다.</p>
<p>Data hazard: load use hazard, write and write hazard</p>
<p>Control hazard: branch prediction wrong</p>
<p>이런 hazard를 해결하는 다양한 방법을 수업시간 때 배웠다.</p></div></div><div class="max-w-3xl mx-auto mt-16 mb-16"><div style="justify-content:space-between;flex-wrap:wrap;margin-bottom:calc(1.25rem * var(--mantine-scale));color:var(--mantine-color-white);width:100%" class="m_8bffd616 mantine-Flex-root __m__-Rdknm"><a class="border border-white/20 rounded-lg md:hover:scale-[1.01] transition hover:shadow-lg duration-200 cursor-pointer drop-shadow-md p-3 mb-3" style="background-image:url(/assets/background/noise50.png)" href="/posts/parametric_surface"><p class="mantine-focus-auto font-sans m_b6d8b162 mantine-Text-root">Previous</p><div style="gap:var(--mantine-spacing-sm);align-items:center" class="m_8bffd616 mantine-Flex-root __m__-Rjddknm"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="tabler-icon tabler-icon-arrow-left "><path d="M5 12l14 0"></path><path d="M5 12l6 6"></path><path d="M5 12l6 -6"></path></svg><p class="mantine-focus-auto text-sm font-sans font-bold text-left m_b6d8b162 mantine-Text-root"> <!-- -->3D Parametric curves and surfaces for computer visualization</p></div></a></div></div><section></section></article></div><div style="background-image:linear-gradient(to bottom, rgba(0,0,0,0), rgba(0,0,0,1));width:100%;height:calc(5rem * var(--mantine-scale));position:fixed;bottom:0rem" class="z-50"></div><div style="height:1000px;background-image:url(/assets/background/noise30.png)" class="absolute bottom-0 bg-red-400 w-full -z-10"><div style="height:500px;width:100%;background-image:linear-gradient(to bottom, rgba(0,0,0,1), rgba(0,0,0,0));position:absolute;top:0rem;left:0rem" class=""></div></div></main></div></main></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"post":{"title":"컴퓨터 구조 - 파이프라인","date":"2022-08-23","slug":"pipeline","author":{"name":"Kim Dong Hun"},"content":"\u003ch2\u003eMake Common Case Fast!\u003c/h2\u003e\n\u003cp\u003e컴퓨터 발전에 있어서 제일 중요한 것은 최적화였다. 어떻게 하면 컴퓨터의 부하를 낮추고 성능을 높일 수 있을까? 이를 접근할 수 있는 방법은 다양하지만, 2022년 1학기 컴퓨터구조 수업에서 배웠던 가장 중요한 것은 common case를 빠르게 만드는 것이었다. 자주 일어나는 것은 최대한 최적화를 하고, 그 과정에서 다른 것이 significant해지면 또 그것을 최적화하는 식으로 최적화를 진행하는 것이다.\u003c/p\u003e\n\u003ch2\u003eTwo most important concepts\u003c/h2\u003e\n\u003cp\u003e교수님께서 말씀하시길 컴퓨터구조에서 면접은 두가지밖에 없다 \u003ccode\u003ePipeline\u003c/code\u003e과 \u003ccode\u003ecache\u003c/code\u003e이다.\u003c/p\u003e\n\u003ch3\u003ePipeline!\u003c/h3\u003e\n\u003cp\u003e여러 instruction을 병렬 수행하는 것이라고 보면 된다. Risc-v에서 배운 pipeline 단계는 Instruction Fetch, Instruction Decode / Register Read, Execute, Memory fetch, Write back 이었다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/posts/pipeline/thumbnail.png\" alt=\"pipeline memo\"\u003e\u003c/p\u003e\n\u003cp\u003e위는 교재 ppt 자료이다. 흔히 어떤 일을 수행하기 위해서 single cycle을 생각하는 것이 흔하다. 하나의 기계가 있다면 그 기계는 일단 하나를 수행 완료한 뒤에 다른 것을 수행하는 것이 정상적으로 느껴진다. 하지만, 수행하는 일을 단계로 나눠서 한꺼번에 여러 단계를 수행할 수 있게 하면 어떨까? 각 단계를 중첩해서 실행하게 하면 걸리는 시간이 크게 줄어지는 것을 확인할 수 있다.\u003c/p\u003e\n\u003cp\u003e이런 것을 병렬적 수행이라고 볼 수 있는데, 하드웨어는 대부분 병렬적 수행을 하도록 프로그램 되어있다고 보아도 괜찮다. (그렇게 안 되어있으면 컴퓨터는 아예 쓰는 게 불가능하다..) 이러한 단계를 나누는 것을 pipeline이라고 하는데, 한 stage에 중첩되어서 최대로 할 수 있는 일의 갯수를 pipeline depth라고 한다. 지금 우리 사진에서는 depth가 5다.\u003c/p\u003e\n\u003cp\u003e다만 pipeline을 성능을 매우 높이더라도 여러 성가신 일들을 벌인다. 예로들면 Register Fetch를 하는데 이전 instruction에서 Mem 단계에서 load해서 값을 업데이트한 register를 실제로 읽어야 한다면 문제가 생긴다. 이럴 경우 해결방법은 해당 inst가 수행 완료될때까지 stall할 수 있다. 하지만 이럴 경우 pipelline을 도입하는 것이 무의미해진다. 동시에 여러 일을 수행하기 위해서 pipeline을 도입했는데, 이전 instruction이 수행 완료 될때까지 기다리는 일을 반복하면 pipeline이 없는 것이랑 다를 바 없다. 이와 같은 성가신 문제들을 hazard라고 부르는데, 여기 컴퓨터 pipeline에서 대표적 hazard는 structural hazard, data hazard, control hazard 가 있다.\u003c/p\u003e\n\u003cp\u003eData hazard: load use hazard, write and write hazard\u003c/p\u003e\n\u003cp\u003eControl hazard: branch prediction wrong\u003c/p\u003e\n\u003cp\u003e이런 hazard를 해결하는 다양한 방법을 수업시간 때 배웠다.\u003c/p\u003e","keyword":"Pipeline","categories":["computer-architecture"],"thumbnail":"/assets/posts/pipeline/thumbnail.png","excerpt":"흔히 어떤 일을 수행하기 위해서 single cycle을 생각하는 것이 흔하다. 하나의 기계가 있다면 그 기계는 일단 하나를 수행 완료한 뒤에 다른 것을 수행하는 것이 정상적으로 느껴진다. 하지만, 수행하는 일을 단계로 나눠서 한꺼번에 여러 단계를 수행할 수 있게 하면 어떨까? 각 단계를 중첩해서 실행하게 하면 걸리는 시간이 크게 줄어지는 것을 확인할 수 있다.","data":{"title":"컴퓨터 구조 - 파이프라인","excerpt":"흔히 어떤 일을 수행하기 위해서 single cycle을 생각하는 것이 흔하다. 하나의 기계가 있다면 그 기계는 일단 하나를 수행 완료한 뒤에 다른 것을 수행하는 것이 정상적으로 느껴진다. 하지만, 수행하는 일을 단계로 나눠서 한꺼번에 여러 단계를 수행할 수 있게 하면 어떨까? 각 단계를 중첩해서 실행하게 하면 걸리는 시간이 크게 줄어지는 것을 확인할 수 있다.","date":"2022-08-23","author":{"name":"Kim Dong Hun"},"keyword":"Pipeline","categories":["computer-architecture"],"WIP":true,"thumbnail":"/assets/posts/pipeline/thumbnail.png"},"nextPath":"","prevPath":"/posts/parametric_surface","prevTitle":"3D Parametric curves and surfaces for computer visualization","nextTitle":"","isMdx":false}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"pipeline"},"buildId":"kHIBZDqh5Me3FZRStPnag","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>